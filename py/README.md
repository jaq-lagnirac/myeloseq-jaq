# Python scripts

## A breakdown of the scripts in this subdirectory.

`annotate_table_vcf.py` - Takes the table generated by `coverage_table.py` and a directory of `.vcf` files for the coverages used and annotates the `set=` (the origin of the coverages). Can handle `dragen`, `pindel`, and `dragen-pindel`, with any other source being counted as a miscellaneous `unknown` set.

`coverage_table.py` - An extension of `json_bed_comparison.py`, takes a directory of directories (generated by `generate_directories.py`) and generates a comparison table to compare the coverage of the requisite `.json` and `.bed` files. Can handle any variant type that is needed (mainly "TIER1-3" and "FILTERED").

`generate_directories.py` - Takes a directory of unsorted `.json` and `.bed` files and copies them into a new main directory, sorted into subdirectories by file name.

`generate_four_plots.py` - An extension of `generate_plot.py`, takes a `.tsv` file generated from `annotate_table_vcf.py` (or alternatively `coverage_table.py`) and generates a `.png` image of four probability density coverage relative difference plots, broken down by set (`dragen`, `pindel`, `dragen-pindel`, and `comparison`).

`generate_four_plots.py` - Takes a `.tsv` file generated from `annotate_table_vcf.py` (or alternatively `coverage_table.py`) and generates a `.png` image of a comparison probability density coverage relative difference plot.

`json_bed_comparison.py` - Takes directory of directories (generated by `generate_directories.py`) and compares the coverage of the requisite `.json` and `.bed` files, outputting the results into a `.err` file.

## A general workflow pipeline

```mermaid
flowchart TD
    originalstate1((".tar.gz of unsorted .json and .bed files"))
    action1{"tar -xvf"}
    state2[("directory of unsorted .json and .bed files")]
    action2{"generate_directories.py"}
    state3[("main directory sorted into subdirectories,
    each with a .json and .bed file")]
    action3{"coverage_table.py"}
    action35{"json_bed_comparison.py"}
    state4[".tsv table file comparing .json and .bed coverages
    and .err file containing statistics"]
    state45[".err file containing statistics"]
    originalstate2((".tar.gz of .vcf files"))
    action21{"tar -xvf"}
    state22[("directory of .vcf files")]
    action4{"annotate_table_vcf.py"}
    state5[".tsv table file annotated with the set/source
    of the coverage information and .err file containing
    statistics"]
    action5{"generate_plot.py"}
    action55{"generate_four_plots.py"}
    state6[".png image of a coverage
    set comparison plot"]
    state65[".png image of four coverage plots
    (dragen, pindel, dragen-pindel, comparison)"]
    action52{"calculate_stats.py"}
    state526[".err file with statistics on
    set coverage, average relative
    difference, and others"]

    originalstate1 --> action1
    action1 --> state2
    state2 --> action2
    action2 --> state3
    state3 --> action3
    state3 --> action35
    action3 --> state4
    state4 --> action4
    action35 --> state45
    originalstate2 --> action21
    action21 --> state22
    state22 --> action4
    action4 --> state5
    state5 --> action5
    state5 --> action55
    action5 --> state6
    action55 --> state65
    state5 --> action52
    action52 --> state526
```